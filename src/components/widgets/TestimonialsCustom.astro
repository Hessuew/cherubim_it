---
import andrewAgbajeHeadshot from '~/assets/images/Andrew Headshot.webp';
import urFitChildLogo from '~/assets/images/siteLogos/urFitChild_logo.webp';
import worldMap from '~/assets/images/worldMap.webp';
import { Icon } from 'astro-icon/components';
---

<div class="relative">
  <!--Waves Container-->
  <!-- <div>
    <svg
      class="waves -top-[120px]"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      viewBox="0 24 150 28"
      preserveAspectRatio="none"
      shape-rendering="auto"
    >
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="parallax">
        <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(81, 35, 131, 0.1)"></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(81, 35, 131, 0.2)"></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill="rgba(81, 35, 131, 0.3)"></use>
      </g>
    </svg>
  </div> -->
  <!--Waves end-->

  <section
    class="creative-testimonial--slider bg-white relative overflow-hidden py-60 px-safe lg:py-32 md:py-24 sm:pb-[68px] sm:pt-20"
  >
    <div class="absolute -z-10 w-full h-[300%] top-[100%] left-0 overflow-visible">
      <div
        class="absolute pointer-events-none opacity-100 transform -translate-x-1/2 -translate-y-1/2 left-1/2 top-1/2"
        style="filter: blur(100px); height: 80vh; width: 180vh; background-image: radial-gradient(circle at 50% 140%, rgba(81, 35, 131, 0.7), rgba(81, 35, 131, 0.7), rgba(255, 170, 64, 0.7));"
      >
      </div>
    </div>
    <div class="testimonial-inner max-w-[1240px] mx-auto relative z-10">
      <div class="testimonial-row">
        <h1 class="text-center text-5xl md:text-7xl font-semibold tracking-tighter text-black pb-7">
          Trusted by the world's fastest
          <br />
          growing research groups
        </h1>
        <div class="testimonial-wrap relative overflow-hidden my-[6%]">
          <div class="swiper-container">
            <div class="swiper-wrapper">
              <!-- Slide 1 -->
              <div class="swiper-slide">
                <div class="swiper-slide--inner px-[15%] flex items-center gap-[50px] relative overflow-x-hidden">
                  <div class="w-[240px] h-[240px] mb-[30px] flex-shrink-0 rounded-full relative">
                    <img src={andrewAgbajeHeadshot.src} alt="" class="w-full h-full object-cover rounded-full" />
                    <div
                      class="absolute bottom-[30px] left-[-10px] w-[68px] h-[68px] bg-[#3c2fc0] rounded-full flex items-center justify-center shadow-md"
                    >
                      <Icon name="tabler:quote-filled" class="quote-icon w-[40px] h-[40px] text-white" />
                    </div>
                  </div>
                  <div class="testimonial-detail">
                    <p class="m-0 text-[#242e45] text-lg leading-[30px] font-medium mb-[5px]">
                      Cherubim IT has been our client for several years, which is a testament to rigorous, painstaking,
                      and excellent work performance. Cherubim IT delivers tasks very promptly, pre-empts challenges,
                      and efficiently tackles them, creates user-friendly platforms, and optimizes the latest IT
                      technology in their work. Cherubim IT customer service is highly considerate, friendly, and
                      humane. I highly recommend Cherubim IT for its impeccable and high-quality IT services. The proof
                      of the pudding is in the eating; a trial will convince you.
                    </p>
                    <span class="text-[#3c2fc0] font-extrabold uppercase text-[15px] leading-normal"
                      >Prof. Andrew Agbaje, urFIT-child, Principal Investigator</span
                    >
                  </div>
                </div>
              </div>
            </div>
            <div class="swiper-button-next slide-btns"></div>
            <div class="swiper-button-prev slide-btns"></div>
          </div>
        </div>
        <!-- Company details -->
        <div class="company-details--row flex flex-wrap w-full justify-center">
          <div class="company-box flex-none w-1/3 px-[15px] sm:px-0 sm:mb-5">
            <div
              class="company-box-inner shadow-lg bg-white/80 text-center rounded-xl overflow-hidden transition-all duration-350"
            >
              <div class="company-box-top py-[25px] px-[20px] border-b border-[#dee2e6]">
                <div class="company-logo-wrapper flex flex-row items-center justify-center gap-3">
                  <img src={urFitChildLogo.src} alt="urFIT-child logo" class="h-[60px] object-contain rounded" />
                  <h3 class="company-name text-[#5a8cc9] m-0 text-2xl font-bold tracking-tight">urFIT-child</h3>
                </div>
              </div>
              <div class="company-box-bottom p-5">
                <span class="text-[15px] text-[#878898] leading-[30px]">
                  All content now in one place - <strong class="text-[#242e45]">Centralized platform</strong></span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<style define:vars={{ worldMapUrl: `url(${worldMap.src})` }}>
  /* Custom styles that can't be easily converted to Tailwind */
  .creative-testimonial--slider::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: var(--worldMapUrl);
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;
    opacity: 0.05;
    z-index: 0;
  }

  /* Responsive styles */
  @media only screen and (max-width: 981px) {
    .swiper-button-next.slide-btns,
    .swiper-button-prev.slide-btns {
      display: none;
    }
  }

  @media only screen and (max-width: 460px) {
    .swiper-slide .swiper-slide--inner {
      flex-direction: column;
      text-align: center;
    }
  }
</style>

<script is:inline>
  // Function to initialize Swiper
  function initializeSwiper() {
    // Check if Swiper is available in the global scope
    if (typeof Swiper !== 'undefined') {
      // Initialize Swiper with configuration
      new Swiper('.swiper-container', {
        loop: true,
        autoplay: {
          delay: 4000,
          disableOnInteraction: false,
        },
        keyboard: {
          enabled: true,
          onlyInViewport: true,
        },
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },
        effect: 'slide',
      });
    } else {
      console.error('Swiper is not defined. Make sure to include the Swiper library.');
    }
  }

  // Initialize on page load with passive event listeners where possible
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeSwiper, { passive: true });
  } else {
    initializeSwiper();
  }

  // Re-initialize on Astro page transitions with passive event listener
  document.addEventListener('astro:page-load', initializeSwiper, { passive: true });
</script>
